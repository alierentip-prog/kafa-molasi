<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Labirent 02 | Yeraltı Üssü</title>
<style>
html,body{margin:0;height:100%;overflow:hidden;background:#000;}
#subtitle{
  position:absolute;bottom:8%;width:100%;text-align:center;
  color:#f5d7b3;font-family:"Poppins",sans-serif;
  font-size:1.1rem;opacity:0;transition:opacity 2s ease;
  text-shadow:0 0 12px rgba(255,210,130,0.8);
}
</style>
</head>
<body>
<div id="subtitle"></div>

<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/examples/jsm/loaders/FontLoader.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/examples/jsm/geometries/TextGeometry.js"></script>

<script>
// === SAHNE ===
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x000000);
scene.fog = new THREE.Fog(0x000000,5,45);

// === KAMERA & RENDER ===
const camera = new THREE.PerspectiveCamera(75,innerWidth/innerHeight,0.1,1000);
camera.position.set(0,1,12);

const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth,innerHeight);
renderer.shadowMap.enabled=true;
document.body.appendChild(renderer.domElement);

// === IŞIKLANDIRMA ===
const ambient = new THREE.AmbientLight(0x705840,0.6);
scene.add(ambient);

const torch = new THREE.PointLight(0xffbb66,2,12);
torch.castShadow=true;
torch.position.set(0,2,8);
scene.add(torch);

// === MALZEMELER ===
const stoneTex = new THREE.MeshStandardMaterial({color:0x443a32,roughness:1,metalness:0.1});
const woodTex = new THREE.MeshStandardMaterial({color:0x6a4e2f,roughness:0.8,metalness:0.2});
const glowMat = new THREE.MeshBasicMaterial({color:0xffa64d});

// === ZEMİN ve DUVARLAR ===
for(let z=0;z<100;z+=5){
  // zemin
  let floor = new THREE.Mesh(new THREE.BoxGeometry(10,0.4,5),stoneTex);
  floor.position.set(0,-3,-z);
  scene.add(floor);
  // tavan
  let ceil = new THREE.Mesh(new THREE.BoxGeometry(10,0.4,5),woodTex);
  ceil.position.set(0,3,-z);
  scene.add(ceil);
  // duvarlar
  let left = new THREE.Mesh(new THREE.BoxGeometry(0.5,6,5),stoneTex);
  left.position.set(-5,0,-z);
  let right = left.clone();
  right.position.x=5;
  scene.add(left,right);
  // fener ışıkları
  if(z%10===0){
    let bulb = new THREE.Mesh(new THREE.SphereGeometry(0.15,12,12),glowMat);
    bulb.position.set(0,2.5,-z);
    scene.add(bulb);
  }
}

// === YAZILAR ===
const loader = new THREE.FontLoader();
loader.load("https://threejs.org/examples/fonts/helvetiker_regular.typeface.json",font=>{
  const texts=[
    {yazi:"Burası güvenli mi?",z:-10},
    {yazi:"Duvarlar nefes alıyor.",z:-25},
    {yazi:"Kapının ardında kim var?",z:-45},
    {yazi:"Kendini kaybetme...",z:-65},
    {yazi:"Sesler... yaklaşıyor.",z:-85}
  ];
  texts.forEach(t=>{
    const geo=new THREE.TextGeometry(t.yazi,{font,size:0.6,height:0.05});
    const mat=new THREE.MeshStandardMaterial({color:0xffcc77,emissive:0xffa040,emissiveIntensity:0.6});
    const mesh=new THREE.Mesh(geo,mat);
    mesh.position.set(-4.5,1,t.z);
    mesh.rotation.y=Math.PI/2;
    scene.add(mesh);
  });
});

// === ALT YAZILAR ===
const subtitles=[
  "Tahta kokusu ağır... ama tanıdık.",
  "Duvarlarda titreşen bir sıcaklık var.",
  "Bir adım daha atıyorsun, yankı büyüyor.",
  "Sanki biri seni izliyor...",
  "Ama nefes almaya devam ediyorsun."
];
const subtitle=document.getElementById("subtitle");
let i=0;
function nextSub(){
  if(i<subtitles.length){
    subtitle.textContent=subtitles[i];
    subtitle.style.opacity=1;
    setTimeout(()=>{subtitle.style.opacity=0;i++;setTimeout(nextSub,2500);},4000);
  } else {
    setTimeout(()=>{window.location.href='labirent-03.html';},4000);
  }
}
setTimeout(nextSub,2000);

// === ANİMASYON ===
function animate(){
  requestAnimationFrame(animate);
  camera.position.z-=0.05;
  torch.position.z=camera.position.z-1;
  renderer.render(scene,camera);
}
animate();

addEventListener("resize",()=>{
  camera.aspect=innerWidth/innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth,innerHeight);
});
</script>
</body>
</html>
