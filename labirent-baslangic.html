<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Labirent Başlangıç | Bilinçaltı</title>
  <style>
    body, html {
      margin: 0;
      overflow: hidden;
      height: 100%;
      background: #000;
      color: #fff;
      font-family: "Poppins", sans-serif;
    }

    #overlayText {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      font-size: 1.5rem;
      opacity: 0;
      transition: opacity 2s ease;
      text-shadow: 0 0 10px #ff9, 0 0 30px #f60;
    }

    #fadeWhite {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: white;
      opacity: 0;
      transition: opacity 2.5s ease;
    }
  </style>
</head>
<body>
  <div id="overlayText">Lütfen PC modunda oynayın</div>
  <div id="fadeWhite"></div>

  <script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>
  <script>
    let scene = new THREE.Scene();
    let camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
    let renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    // Işık
    const light = new THREE.PointLight(0xffb266, 2, 25);
    light.position.set(0, 1.8, 2);
    scene.add(light);
    scene.add(new THREE.AmbientLight(0x2a1a0a, 0.4));

    // Dokular
    const loader = new THREE.TextureLoader();
    const wallTex = loader.load('https://threejsfundamentals.org/threejs/resources/images/wall.jpg');
    wallTex.wrapS = wallTex.wrapT = THREE.RepeatWrapping;
    wallTex.repeat.set(6, 6);
    const wallMat = new THREE.MeshStandardMaterial({ map: wallTex });

    // Koridor
    const corridor = [];
    for (let i = 0; i < 20; i++) {
      let wallL = new THREE.Mesh(new THREE.BoxGeometry(10, 6, 0.5), wallMat);
      wallL.position.set(-5, 1, -i * 6);
      scene.add(wallL);
      corridor.push(wallL);

      let wallR = new THREE.Mesh(new THREE.BoxGeometry(10, 6, 0.5), wallMat);
      wallR.position.set(5, 1, -i * 6);
      scene.add(wallR);
      corridor.push(wallR);

      let floor = new THREE.Mesh(new THREE.BoxGeometry(10, 0.2, 6), new THREE.MeshStandardMaterial({ color: 0x1a1a1a }));
      floor.position.set(0, -2, -i * 6);
      scene.add(floor);
      corridor.push(floor);
    }

    // Kamera
    camera.position.set(0, 1.5, 5);

    // Altyazı dizisi
    const texts = [
      "Bu labirente kendi isteğinle girdin...",
      "Her köşede bir ses yankılanır...",
      "Kaçış yok.",
      "Sadece kendini bulmak var..."
    ];
    let textIndex = 0;
    let overlay = document.getElementById("overlayText");

    function showNextText() {
      if (textIndex < texts.length) {
        overlay.textContent = texts[textIndex];
        overlay.style.opacity = 1;
        setTimeout(() => {
          overlay.style.opacity = 0;
          textIndex++;
          setTimeout(showNextText, 1500);
        }, 2500);
      }
    }

    setTimeout(showNextText, 3000);

    let progress = 0;
    let running = false;
    let finished = false;

    function animate() {
      requestAnimationFrame(animate);
      progress += 0.015;

      if (!running) camera.position.z -= 0.05;
      light.position.z = camera.position.z - 1;

      // Kamera ani dönme efekti
      if (progress > 8 && !running) {
        running = true;
        overlay.textContent = "Bir ses mi duydun?..";
        overlay.style.opacity = 1;
        setTimeout(() => { overlay.style.opacity = 0; }, 2000);
      }

      if (running && camera.position.z > -70) {
        camera.rotation.y = Math.sin(progress * 2) * 0.15;
        camera.position.z -= 0.15; // koşu efekti
      }

      if (camera.position.z < -70 && !finished) {
        finished = true;
        document.getElementById("fadeWhite").style.opacity = 1;
        setTimeout(() => { window.location.href = "labirent-02.html"; }, 3000);
      }

      renderer.render(scene, camera);
    }

    animate();

    window.addEventListener("resize", () => {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });
  </script>
</body>
</html>
