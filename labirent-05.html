<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Bilinç Kütüphanesi</title>
<script src="https://cdn.jsdelivr.net/npm/three@0.152.0/build/three.min.js"></script>
<style>
  html, body {
    margin: 0;
    height: 100%;
    overflow: hidden;
    background: #000;
    color: #fff;
    font-family: "Poppins", sans-serif;
  }
  #overlay {
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    background: radial-gradient(ellipse at center, rgba(0,0,0,0.7), #000);
    opacity: 0;
    transition: opacity 2s ease;
    text-align: center;
  }
  #overlay.visible {
    opacity: 1;
  }
  #overlay p {
    font-size: 1.8rem;
    max-width: 70%;
    color: #f5e6ca;
    text-shadow: 0 0 25px rgba(255, 186, 120, 0.8);
  }
</style>
</head>
<body>
<canvas id="scene"></canvas>
<div id="overlay"><p></p></div>

<script>
let scene, camera, renderer, clock, mixer;
const overlay = document.getElementById("overlay");
const textBox = overlay.querySelector("p");

init();
animate();

function init(){
  scene = new THREE.Scene();
  camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 2000);
  camera.position.set(0, 3, 10);

  renderer = new THREE.WebGLRenderer({canvas: document.getElementById("scene"), antialias: true});
  renderer.setSize(window.innerWidth, window.innerHeight);
  renderer.shadowMap.enabled = true;

  clock = new THREE.Clock();

  // Zemin
  const floorTex = new THREE.TextureLoader().load("https://cdn.pixabay.com/photo/2016/10/22/16/32/floor-1769556_1280.jpg");
  floorTex.wrapS = floorTex.wrapT = THREE.RepeatWrapping;
  floorTex.repeat.set(8,8);
  const floor = new THREE.Mesh(
    new THREE.PlaneGeometry(100,100),
    new THREE.MeshStandardMaterial({map: floorTex})
  );
  floor.rotation.x = -Math.PI/2;
  floor.receiveShadow = true;
  scene.add(floor);

  // Duvarlar
  const wallTex = new THREE.TextureLoader().load("https://cdn.pixabay.com/photo/2017/07/25/17/14/stone-2531416_1280.jpg");
  const wallMat = new THREE.MeshStandardMaterial({map: wallTex});
  const leftWall = new THREE.Mesh(new THREE.BoxGeometry(1,6,100), wallMat);
  leftWall.position.set(-5,3,0);
  const rightWall = new THREE.Mesh(new THREE.BoxGeometry(1,6,100), wallMat);
  rightWall.position.set(5,3,0);
  const backWall = new THREE.Mesh(new THREE.BoxGeometry(10,6,1), wallMat);
  backWall.position.set(0,3,-50);
  scene.add(leftWall,rightWall,backWall);

  // Meşale ışıkları
  const torches = [];
  for(let z=-50; z<50; z+=20){
    const light = new THREE.PointLight(0xffb266, 2, 15);
    light.position.set(-4.5, 3, z);
    scene.add(light);
    const light2 = new THREE.PointLight(0xffb266, 2, 15);
    light2.position.set(4.5, 3, z+10);
    scene.add(light2);
    torches.push(light, light2);
  }

  // Sis ve ortam ışığı
  scene.fog = new THREE.FogExp2(0x000000, 0.03);
  const ambient = new THREE.AmbientLight(0x404040, 0.5);
  scene.add(ambient);

  // Toz parçacıkları
  const particles = new THREE.Group();
  const particleGeo = new THREE.SphereGeometry(0.03, 8, 8);
  const particleMat = new THREE.MeshBasicMaterial({color: 0xffe0b3});
  for(let i=0;i<400;i++){
    const p = new THREE.Mesh(particleGeo, particleMat);
    p.position.set((Math.random()-0.5)*10, Math.random()*5, (Math.random()-0.5)*100);
    particles.add(p);
  }
  scene.add(particles);

  // Yazılar
  const texts = [
    "Her kitap bir zihin, her sessizlik bir cevap.",
    "Bilgi, sabırla fısıldar.",
    "Işık, sadece karanlıkta anlam bulur.",
    "Kendini bulmak için kaybolman gerekir."
  ];
  let textIndex = 0;
  let lastTextTime = 0;

  // Kamera ilerleme
  function update(){
    const t = clock.getElapsedTime();
    camera.position.z -= 0.03;
    if(particles){
      particles.children.forEach(p=>{
        p.position.z += 0.05;
        if(p.position.z>camera.position.z+10) p.position.z = camera.position.z - 100;
      });
    }

    if(t - lastTextTime > 6 && textIndex < texts.length){
      overlay.classList.add("visible");
      textBox.textContent = texts[textIndex];
      lastTextTime = t;
      setTimeout(()=>{
        overlay.classList.remove("visible");
        textIndex++;
      }, 4000);
    }

    if(camera.position.z < -52){
      fadeOut();
    }
  }

  function fadeOut(){
    const fade = document.createElement("div");
    fade.style.position = "fixed";
    fade.style.top = "0";
    fade.style.left = "0";
    fade.style.width = "100%";
    fade.style.height = "100%";
    fade.style.background = "#fff";
    fade.style.opacity = "0";
    fade.style.transition = "opacity 3s ease";
    document.body.appendChild(fade);
    setTimeout(()=>{fade.style.opacity="1";},100);
    setTimeout(()=>{
      textBox.textContent = "Ve ışık seni buldu.";
      overlay.classList.add("visible");
    },2500);
  }

  // Her karede çağrılacak
  function animate(){
    requestAnimationFrame(animate);
    update();
    renderer.render(scene,camera);
  }
  animate();
}
</script>
</body>
</html>
