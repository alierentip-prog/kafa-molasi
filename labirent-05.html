<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Labirent 05 | Bilinçaltı</title>
<style>
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  overflow: hidden;
  background: radial-gradient(circle at center, #0d0b0b 40%, #000);
  color: #fff;
  font-family: "Poppins", sans-serif;
}
canvas {
  display: block;
  width: 100%;
  height: 100%;
}

/* Altyazılar */
#subtitles {
  position: absolute;
  bottom: 60px;
  width: 100%;
  text-align: center;
  font-size: 1.2rem;
  color: #f5e3b3;
  text-shadow: 0 0 12px rgba(255,220,140,0.8);
  opacity: 0;
  transition: opacity 2s ease;
}

/* Kapı efekti */
#door {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0);
  width: 240px;
  height: 400px;
  background: url('https://i.imgur.com/zY6uEIo.jpeg') center/cover no-repeat;
  border: 3px solid rgba(80,50,20,0.9);
  box-shadow: 0 0 40px rgba(255,200,120,0.4);
  opacity: 0;
  border-radius: 8px;
  transition: all 2.5s ease;
}

/* Işık patlaması */
#flash {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: white;
  opacity: 0;
  transition: opacity 3s ease;
}
</style>
</head>
<body>

<canvas id="scene"></canvas>
<div id="subtitles"></div>
<div id="door"></div>
<div id="flash"></div>

<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>
<script>
// === Three.js sahne ayarları ===
let scene = new THREE.Scene();
let camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
let renderer = new THREE.WebGLRenderer({ canvas: document.getElementById("scene"), antialias: true });
renderer.setSize(window.innerWidth, window.innerHeight);

// === Işıklar ===
const ambientLight = new THREE.AmbientLight(0x403020, 0.8);
const torchLight = new THREE.PointLight(0xffa95c, 1.4, 15);
torchLight.position.set(0, 2, 2);
scene.add(ambientLight, torchLight);

// === Zemine ve duvarlara doku ===
const wallTexture = new THREE.TextureLoader().load("https://i.imgur.com/GJjwcKv.jpeg");
wallTexture.wrapS = wallTexture.wrapT = THREE.RepeatWrapping;
wallTexture.repeat.set(4, 2);

const floorTexture = new THREE.TextureLoader().load("https://i.imgur.com/tUj8yJ3.jpeg");
floorTexture.wrapS = floorTexture.wrapT = THREE.RepeatWrapping;
floorTexture.repeat.set(6, 6);

const wallMaterial = new THREE.MeshStandardMaterial({ map: wallTexture });
const floorMaterial = new THREE.MeshStandardMaterial({ map: floorTexture });

let floor = new THREE.Mesh(new THREE.PlaneGeometry(20, 20), floorMaterial);
floor.rotation.x = -Math.PI / 2;
scene.add(floor);

// === Duvarlar ===
function makeWall(x, z, w, h, d) {
  let wall = new THREE.Mesh(new THREE.BoxGeometry(w, h, d), wallMaterial);
  wall.position.set(x, h/2, z);
  scene.add(wall);
}
makeWall(0, -10, 20, 4, 1);
makeWall(0, 10, 20, 4, 1);
makeWall(-10, 0, 1, 4, 20);
makeWall(10, 0, 1, 4, 20);
makeWall(0, -2, 6, 4, 1);
makeWall(6, 2, 8, 4, 1);
makeWall(-6, 4, 8, 4, 1);
makeWall(0, 8, 6, 4, 1);

// === Kamera başlangıç konumu ===
camera.position.set(0, 1.8, 9);

// === Sis efekti ===
scene.fog = new THREE.FogExp2(0x0c0a09, 0.07);

// === Yavaş yürüyüş animasyonu ===
let t = 0;
function animate() {
  requestAnimationFrame(animate);
  t += 0.004;
  camera.position.z = 9 - t * 4;
  camera.position.x = Math.sin(t) * 2;
  camera.lookAt(0, 1, 0);
  renderer.render(scene, camera);
}
animate();

// === Altyazılar ===
const subtitles = [
  "Duvarlarda hiyeroglifler yanıyor...",
  "Her sembol bir anıyı fısıldıyor.",
  "Ayak seslerin yankılanıyor...",
  "Bir kapı var ileride... ağır... tahta...",
  "Yaklaştıkça kalbin hızlanıyor.",
  "Kapı seni çağırıyor..."
];
const subDiv = document.getElementById("subtitles");

let i = 0;
function showSub() {
  if (i < subtitles.length) {
    subDiv.textContent = subtitles[i];
    subDiv.style.opacity = 1;
    setTimeout(() => {
      subDiv.style.opacity = 0;
      i++;
      setTimeout(showSub, 2000);
    }, 4000);
  } else {
    document.getElementById("door").style.opacity = 1;
    document.getElementById("door").style.transform = "translate(-50%, -50%) scale(1)";
    setTimeout(() => {
      document.getElementById("flash").style.opacity = 1;
      setTimeout(() => { window.location.href = "labirent-06.html"; }, 4000);
    }, 7000);
  }
}
setTimeout(showSub, 2000);

// === Pencere yeniden boyutlandığında ===
window.addEventListener("resize", () => {
  camera.aspect = window.innerWidth / window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
});
</script>

</body>
</html>
