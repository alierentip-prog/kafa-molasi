<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bilinç Odası – Labirent 05</title>
<style>
html,body{margin:0;height:100%;overflow:hidden;background:#000;}
#subtitle{
  position:absolute;bottom:8%;width:100%;text-align:center;
  color:#f8e9d6;font-family:"Poppins",sans-serif;font-size:1.15rem;
  opacity:0;transition:opacity 2s ease;
  text-shadow:0 0 18px rgba(255,230,180,0.8);
}
#fadeBlack{
  position:absolute;top:0;left:0;width:100%;height:100%;
  background:black;opacity:0;transition:opacity 3s ease;
}
</style>
</head>
<body>
<div id="subtitle"></div>
<div id="fadeBlack"></div>

<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>
<script>
const scene = new THREE.Scene();
scene.fog = new THREE.FogExp2(0x2b1c0f, 0.03);

const camera = new THREE.PerspectiveCamera(70, innerWidth/innerHeight, 0.1, 1000);
const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth, innerHeight);
renderer.shadowMap.enabled = true;
document.body.appendChild(renderer.domElement);

// IŞIKLAR
const warm = new THREE.PointLight(0xffc88a,2,25);
warm.position.set(0,4,3);
scene.add(warm);
scene.add(new THREE.AmbientLight(0x3a2a1b,0.6));

// DOKULAR
const loader=new THREE.TextureLoader();
const wood = loader.load("https://i.imgur.com/kViQz4k.jpeg");
wood.wrapS=wood.wrapT=THREE.RepeatWrapping;
const stone = loader.load("https://i.imgur.com/mN6ThvY.jpeg");
stone.wrapS=stone.wrapT=THREE.RepeatWrapping;
const bookshelf = loader.load("https://i.imgur.com/2Yp8M7S.jpeg"); // kitap dokusu

const woodMat=new THREE.MeshStandardMaterial({map:wood,roughness:0.8});
const stoneMat=new THREE.MeshStandardMaterial({map:stone,roughness:1});
const shelfMat=new THREE.MeshStandardMaterial({map:bookshelf});

// ODA GEOMETRİSİ
const floor=new THREE.Mesh(new THREE.BoxGeometry(15,1,15),stoneMat);
floor.position.set(0,-2,0);
scene.add(floor);
const ceiling=new THREE.Mesh(new THREE.BoxGeometry(15,1,15),woodMat);
ceiling.position.set(0,3,0);
scene.add(ceiling);

const backWall=new THREE.Mesh(new THREE.BoxGeometry(15,5,1),woodMat);
backWall.position.set(0,0,-7);
scene.add(backWall);
const frontWall=new THREE.Mesh(new THREE.BoxGeometry(15,5,1),woodMat);
frontWall.position.set(0,0,7);
scene.add(frontWall);
const leftWall=new THREE.Mesh(new THREE.BoxGeometry(1,5,15),woodMat);
leftWall.position.set(-7,0,0);
scene.add(leftWall);
const rightWall=new THREE.Mesh(new THREE.BoxGeometry(1,5,15),woodMat);
rightWall.position.set(7,0,0);
scene.add(rightWall);

// KÜTÜPHANE RAFI
for(let i=-4;i<=4;i+=4){
  const shelf=new THREE.Mesh(new THREE.BoxGeometry(6,3,0.8),shelfMat);
  shelf.position.set(i,0,-6.5);
  scene.add(shelf);
}

// HALI
const carpetTex=loader.load("https://i.imgur.com/Ez2Qayb.jpeg");
carpetTex.wrapS=carpetTex.wrapT=THREE.RepeatWrapping;
const carpet=new THREE.Mesh(new THREE.PlaneGeometry(6,3),new THREE.MeshStandardMaterial({map:carpetTex,side:THREE.DoubleSide}));
carpet.rotation.x=-Math.PI/2;
carpet.position.set(0,-1.49,0);
scene.add(carpet);

// KAPI
const doorTex=loader.load("https://i.imgur.com/nSt1Mjq.jpeg");
const doorMat=new THREE.MeshStandardMaterial({map:doorTex});
const door=new THREE.Mesh(new THREE.BoxGeometry(2,3,0.2),doorMat);
door.position.set(0,0,6.4);
scene.add(door);

// ALT YAZILAR
const subtitles=[
  "Kapı... tahta bir kapı. Sanki yıllardır bekliyor.",
  "Duvarlar nefes alıyor gibi...",
  "Zaman burada durmuş olabilir.",
  "Bir şey... seni çağırıyor.",
  "Kapı yavaşça açılıyor..."
];
const subtitle=document.getElementById("subtitle");
const fadeBlack=document.getElementById("fadeBlack");
let idx=0;
function showNext(){
  if(idx<subtitles.length){
    subtitle.textContent=subtitles[idx];
    subtitle.style.opacity=1;
    setTimeout(()=>{subtitle.style.opacity=0;idx++;setTimeout(showNext,2500);},4000);
  }else openDoor();
}
setTimeout(showNext,2500);

// KAMERA
camera.position.set(0,0,0);
let t=0;
function animate(){
  requestAnimationFrame(animate);
  t+=0.005;
  camera.position.x=Math.sin(t)*0.3;
  camera.position.y=Math.sin(t*2)*0.1;
  renderer.render(scene,camera);
}
animate();

// KAPI AÇILMA
function openDoor(){
  let rot=0;
  const interval=setInterval(()=>{
    door.rotation.y-=0.03;
    rot+=0.03;
    if(rot>1.5){
      clearInterval(interval);
      fadeBlack.style.opacity=1;
      setTimeout(()=>window.location.href="labirent-06.html",3000);
    }
  },40);
}

// resize
addEventListener("resize",()=>{
  camera.aspect=innerWidth/innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth,innerHeight);
});
</script>
</body>
</html>
